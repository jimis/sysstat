# @SYSTEMD_UNIT_DIR@/sysstat.service
# (C) 2012 Peter Schiffer (pschiffe <at> redhat.com)
#
# @PACKAGE_NAME@-@PACKAGE_VERSION@ systemd unit file:
#     1. Insert a dummy record in current daily data file when starting/stopping
#        the unit. This indicates that the counters have restarted from 0.
#     2. This unit is automatically stopped/started on suspend/resume,
#        see /usr/lib/systemd/system-sleep/sysstat-sleep.sh.
#     3. Starting this unit also starts the timer unit for periodic accounting.

[Unit]
Description=System Activity Accounting
# Start the periodic accounting process
Requires=sysstat-collect.timer
# but make sure we finish first, because the accounting process locks the datafile
Before=sysstat-collect.timer sysstat-collect.service

[Service]
Type=oneshot
RemainAfterExit=yes
User=@CRON_OWNER@
ExecStart=@SA_LIB_DIR@/sa1 --boot -C STARTED
ExecStop=@SA_LIB_DIR@/sa1 --boot -C STOPPED

[Install]
WantedBy=multi-user.target
Also=sysstat-collect.timer
Also=sysstat-summary.timer
